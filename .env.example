# OpenAlex Database - Environment Configuration Template
# Copy this file to .env and update with your actual values
# IMPORTANT: Never commit .env to git - it contains sensitive passwords

#------------------------------------------------------------------------------
# DATABASE CONFIGURATION
#------------------------------------------------------------------------------

# Database connection settings
# When running in Docker containers, use DB_HOST=postgres (container name)
# When running locally on Mac, use DB_HOST=192.168.1.162 (NAS IP)
DB_HOST=postgres
DB_PORT=5432
DB_NAME=oadbv5
DB_USER=admin

# Database passwords (CHANGE THESE FOR PRODUCTION)
ADMIN_PASSWORD=secure_password_123
READONLY_USER=user1
READONLY_PASSWORD=OAUserLetmein!234

#------------------------------------------------------------------------------
# FILE PATHS
#------------------------------------------------------------------------------

# Snapshot data location
# On NAS: /Volumes/Series/25NOV2025/data
# In container: /data (mapped via docker-compose.yml)
SNAPSHOT_PATH=/Volumes/Series/25NOV2025/data
SNAPSHOT_DIR=/data

# Log directory
# In container: /logs (mapped to /volume1/docker/openalex/logs on NAS)
LOG_DIR=/logs

# Parsing directory
# In container: /app/03_snapshot_parsing
PARSING_DIR=/app/03_snapshot_parsing

# Backup directory
# In container: /backups (mapped to /volume2/postgres_backup on NAS - slower HDD storage)
BACKUP_DIR=/backups

#------------------------------------------------------------------------------
# POSTGRESQL OPTIMIZATION
#------------------------------------------------------------------------------

# PostgreSQL memory and connection settings
POSTGRES_MAX_CONNECTIONS=200
POSTGRES_SHARED_BUFFERS=4GB
POSTGRES_WORK_MEM=256MB
POSTGRES_MAINTENANCE_WORK_MEM=2GB

#------------------------------------------------------------------------------
# BACKUP CONFIGURATION
#------------------------------------------------------------------------------

# Backup retention policy
BACKUP_RETENTION_DAYS=7          # Keep daily backups for 7 days
BACKUP_RETENTION_WEEKS=4         # Keep weekly backups for 4 weeks

#------------------------------------------------------------------------------
# PARSER CONFIGURATION
#------------------------------------------------------------------------------

# Parsing batch and performance settings
BATCH_SIZE=50000                 # Records to accumulate before COPY
PARALLEL_PARSERS=4               # Number of parsers to run in parallel
PROGRESS_INTERVAL=10000          # Print progress every N lines

#------------------------------------------------------------------------------
# NOTES
#------------------------------------------------------------------------------
#
# Setup Instructions:
# 1. Copy this file: cp .env.example .env
# 2. Update all passwords with strong, unique values
# 3. Adjust paths if using different locations
# 4. Verify SNAPSHOT_PATH points to your actual snapshot data
# 5. Never commit .env to version control
#
# For production deployments:
# - Use strong passwords (at least 16 characters, mixed case, numbers, symbols)
# - Consider using password managers or secrets management systems
# - Restrict file permissions: chmod 600 .env
# - Back up .env securely (encrypted, separate from code)
#
